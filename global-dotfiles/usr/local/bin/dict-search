#!/bin/python
import os
import sys
import requests

app_id, app_key  = os.getenv('OXFORD_app_id'), os.getenv('OXFORD_app_key')
language, cont = sys.argv[2] if len(sys.argv) == 3 else 'en', 'y'

while cont != 'n':
    word_id = sys.argv[1] if len(sys.argv) > 1 else input("\nSearch dictionary...\n")
    url = 'https://od-api.oxforddictionaries.com:443/api/v2/entries/'  + language + '/'  + word_id.strip().lower()

    try:
        r = requests.get(url, headers = {'app_id' : app_id, 'app_key' : app_key})
        data = r.json()
        if r.status_code != 200:
            print("No results found")
            code = 1
        else:
            results = data["results"][0]["lexicalEntries"][0]["entries"][0]["senses"]
            for j,i in enumerate(results,1):
                print(str(j)+" =>", "Definitions :- {}".format(i.get("definitions")), "Domains :- {}".format(i.get("domains")), "Examples :- {}".format(i.get("examples")), "Synonyms :- {}".format(i.get("synonyms")), sep="\n",end="\n\n")
            code = 0
    except Exception as e:
        print(e)
    cont = sys.exit(code) if len(sys.argv) > 1 else input("Continue y/n ")
