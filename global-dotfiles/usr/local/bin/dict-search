#!/bin/python3
from argparse import ArgumentParser
from os import getenv
from requests import get
from sys import exit

app_id, app_key  = getenv('OXFORD_app_id'), getenv('OXFORD_app_key')

parser = ArgumentParser(prog = "dict-search", description = "Search word in oxford dictionary.")
parser.add_argument("word", help = "word to be searched")
parser.add_argument("-lan", default = "en", help = "language code, default en", metavar = "code")
args = parser.parse_args()

code, url = 1, 'https://od-api.oxforddictionaries.com:443/api/v2/entries/'  + args.lan + '/'  + args.word.strip().lower()

try:
    r = get(url, headers = {'app_id' : app_id, 'app_key' : app_key}, timeout = 10)
    data = r.json()
    if r.status_code != 200:
        print("No results found")
    else:
        results = data["results"][0]["lexicalEntries"][0]["entries"][0]["senses"]
        for j,i in enumerate(results,1):
            print(str(j)+" =>", "Definitions :- {}".format(i.get("definitions")), "Domains :- {}".format(i.get("domains")), "Examples :- {}".format(i.get("examples")), "Synonyms :- {}".format(i.get("synonyms")), sep="\n",end="\n\n")
        code = 0
except Exception as e:
    print(e)
exit(code)
